import gmpy2
from gmpy2 import iroot,invert

def asc2str(strs):
    result = ''
    if (len(strs) % 2) == 0 :
        strs = strs[2:]
    else:
        strs = strs[2:]
        strs = '0' + strs
    result = strs.decode('hex')
    print result
    return result



n1=0x43d819a4caf16806e1c540fd7c0e51a96a6dfdbe68735a5fd99a468825e5ee55c4087106f7d1f91e10d50df1f2082f0f32bb82f398134b0b8758353bdabc5ba2817f4e6e0786e176686b2e75a7c47d073f346d6adb2684a9d28b658dddc75b3c5d10a22a3e85c6c12549d0ce7577e79a068405d3904f3f6b9cc408c4cd8595bf67fe672474e0b94dc99072caaa4f866fc6c3feddc74f10d6a0fb31864f52adef71649684f1a72c910ec5ca7909cc10aef85d43a57ec91f096a2d4794299e967fcd5add6e9cfb5baf7751387e24b93dbc1f37315ce573dc063ecddd4ae6fb9127307cfc80a037e7ff5c40a5f7590c8b2f5bd06dd392fbc51e5d059cffbcb85555
c1=0x270004408a0f9085316cd605e152225eb4486138f7d7e701f586716faf6054146432e502a92f5eb0451383e99b1bc5f0afb337389218ec4db61fa8ada9aea93ef8a30958ea72ed04178abaf833ed071d3290c2815caa1a99fa4b30ee96a3d9a664544613b26a3dbc60627b762fbc7cbc06d584b42ccea636606566f5a17e4f135f7cff5b08c05f33c0ad48f3d39a1797f047ea50f4fea4783d39f971e2d735ff1efc7f1fc690c04657f731917e90e6687644d5db643427e488114a26b7ff31884ce70bedc0620516aab82eb567f636ba67dc642d09688f03b0fa516f9e7f7e27b89174da0ca05438bb280848fb0457a0e1491cc0d7a80dd17e73204437146d71
n2=0x60d175fdb0a96eca160fb0cbf8bad1a14dd680d353a7b3bc77e620437da70fd9153f7609efde652b825c4ae7f25decf14a3c8240ea8c5892003f1430cc88b0ded9dae12ebffc6b23632ac530ac4ae23fbffb7cfe431ff3d802f5a54ab76257a86aeec1cf47d482fec970fc27c5b376fbf2cf993270bba9b78174395de3346d4e221d1eafdb8eecc8edb953d1ccaa5fc250aed83b3a458f9e9d947c4b01a6e72ce4fee37e77faaf5597d780ad5f0a7623edb08ce76264f72c3ff17afc932f5812b10692bcc941a18b6f3904ca31d038baf3fc1968d1cc0588a656d0c53cd5c89cedba8a5230956af2170554d27f524c2027adce84fd4d0e018dc88ca4d5d26867
c2=0x218b37071a30e6276e543c9f0a2f4a1d8d61a10afba951fa33df6e705388b8b8b6a6c468b7643088a6ffed56f3e3a58c05195942d40d231fcd1ab4775c9c0f3beb10d38d736e1c1f3d093b16ce934e7fd3422f3fc66360eec34b9800ff78d07c1a0bb53cfbe4ecb36724f1bcb69e25b50ad6df3ea8a7864de223ca48540dec8c77be550b9548b6f2c481d8ebaec2b9cdb1ce985e0c48914c436f895571396085c7473bc19259a0f9fd4602718e8c4a52695ed392729104af211b9ffef2324ce738e18f8bd7ae8205181d63048b41625f1ef0d6a4743331e42c41cf19b48c92a3185049dc8cec17f914b4dd2acf1659c1a3764f9d2d38063dfe0896b547c0cf72
n3=0x280f992dd63fcabdcb739f52c5ed1887e720cbfe73153adf5405819396b28cb54423d196600cce76c8554cd963281fc4b153e3b257e96d091e5d99567dd1fa9ace52511ace4da407f5269e71b1b13822316d751e788dc935d63916075530d7fb89cbec9b02c01aef19c39b4ecaa1f7fe2faf990aa938eb89730eda30558e669da5459ed96f1463a983443187359c07fba8e97024452087b410c9ac1e39ed1c74f380fd29ebdd28618d60c36e6973fc87c066cae05e9e270b5ac25ea5ca0bac5948de0263d8cc89d91c4b574202e71811d0ddf1ed23c1bc35f3a042aac6a0bdf32d37dede3536f70c257aafb4cfbe3370cd7b4187c023c35671de3888a1ed1303
c3=0x15756c5884f272a92d8434f13bcf98e6029c6a51dd57d6ee899115c5d19879e4daf7be85d63fd1b2a69647c8d1cf40b7d3856ac9120f2bba861fa663c85b5af25c7bf48481d5799fa6c5bf62e5617b1f6f899a9b50652aeeb5b93ca3df954422f95794126459d499d8cc7def5bf5c6019adfbd29e5d04f3936f6421ec6e703dffa3b9b6f04e73ca75abf034d5acea877c38df6da674124ca7890a0ccdaca4b04e0d7662e230bf8bd52ee66f6a121b733ab32564a2aaaaf297982bc912afd5790d839580443dc77e6f22e90e38c8dae464ca64505601d3a2b015f9ae1bb15d978f013e3dfe5ad7bfbaaa2e5e78c6609710d17b5c7bf485b22f6dd39c3344869ac
e=0x3

n = [n1, n2, n3]
C = [c1, c2, c3]
N = 1
for i in n:
    N *= i
Ni = []
for i in n:
    Ni.append(N / i)
T = []
for i in xrange(3):
    T.append(long(invert(Ni[i], n[i])))
X = 0
for i in xrange(3):
    X += C[i] * Ni[i] * T[i]
m3 = X % N
m = iroot(m3, 3)

asc2str(hex(m[0]))


#M = "halfbit{Bro4dc4st_4tt4ck_1s_so_e4sy}paddingAAAAAAABBBBBBBBCCCCCCCDDDDDDEEEEDDDDDDEEEEEEEEE"
#M1 = int(M.encode('hex'),16)
#ci1 = gmpy2.powmod(M1, e, n1)
#ci2 = gmpy2.powmod(M1, e, n2)
#ci3 = gmpy2.powmod(M1, e, n3)

#print hex(ci1)
#print hex(ci2)
#print hex(ci3)
